const cvList = [
  {
    "name": "pericardial cavity",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "visceral pericardium (aka. Epicardium)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "parietal pericardium",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "endocardium",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "myocardium",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "systemic circulation",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "pulmonary circulation",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left common carotid artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left subclavian artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "aortic arch",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "ligamentum arteriosum",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left pulmonary artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left pulmonary veins",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "auricle",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "circumflex artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left coronary artery (in coronary sulcus)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "great cardiac vein",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "anterior interventricular artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "apex",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "brachipcephalic trunk",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "superior vena cava",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right pulmonary artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "ascending aorta",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "pulmonary trunk",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right pulmonary veins",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "anterior cardiac vein",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right ventricle",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "marginal artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "small cardiac vein",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "inferior vena cava",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left atrium",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "mitral (bicuspid) valve",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "pulmonary valve",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left ventricle",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "papillary muscle",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "interventricular septum",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "myocardium (alternate view)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right atrium",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "fossa ovale",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "tricuspid valve",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "chordae tendinae",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "trabeculae carneae",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "arch of aorta (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left pulmonary artery (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left pulmonary veins (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left atrium (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left ventricle (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "coronary sinus (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right ventricle (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "inferior vena cava (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right pulmonary veins (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "superior vena cava (posterior)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "AV valve (open, closed)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "SL (semiulunar) valves (open and closed)",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "left coronary artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "right coronary artery",
    "category": "heart anatomy",
    "definition": ""
  },
  {
    "name": "ventricular contraction, relaxation",
    "category": "heart (other)",
    "definition": ""
  },
  {
    "name": "atherosclerosis",
    "category": "heart (other)",
    "definition": ""
  },
  {
    "name": "angioplasty (with stent)",
    "category": "heart (other)",
    "definition": ""
  },
  {
    "name": "coronary bypass surgery (CABG)",
    "category": "heart (other)",
    "definition": ""
  },
  {
    "name": "hypertrophic cardiomyopathy (HCM)",
    "category": "heart (other)",
    "definition": ""
  },
  {
    "name": "dilated cardiomyopathy (DCM)",
    "category": "heart (other)",
    "definition": ""
  },
  {
    "name": "cardiac muscle cell (single nucleus)",
    "category": "cardiac muscle",
    "definition": ""
  },
  {
    "name": "cardiac muscle cell (intercalcated discs)",
    "category": "cardiac muscle",
    "definition": ""
  },
  {
    "name": "cardiac muscle cell (striations)",
    "category": "cardiac muscle",
    "definition": ""
  },
  {
    "name": "cardiac muscle cell (gap function, electrical current)",
    "category": "cardiac muscle",
    "definition": ""
  },
  {
    "name": "cardiac muscle cell (desmosome)",
    "category": "cardiac muscle",
    "definition": ""
  },
  {
    "name": "Sinoatrial (SA) node (pacemaker)",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "internodal pathway",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "atrioventricular (AV) node",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "atrioventricular (AV) bundle (Bundle of His)",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "perkinje fibers",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "parasympathetic stimulation",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "sympathetic stimulation",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "sympathetic cardiac nerve",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "vagus nerve",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "sympathetic trunk ganglion",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "medulla oblongata",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "cardiac center (of medulla oblongata)",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "ECG T wave (ventricular repolarization)",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "ECG P wave (atrial depolarization)",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "ECG QRS complex (ventricular depolarization)",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "ECG junctional rhythm",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "ECG second-degree heart block",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "ventricular fibrilation",
    "category": "heart (electrical)",
    "definition": ""
  },
  {
    "name": "EDV (end diastolic volume)",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "stroke volume",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "ESV (end systolic volume)",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "Vein",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Venule",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Capillaries",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Arteriole",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Artery",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Serosa (epithelial cells)",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Tunica externa (loose fibrous connective tissue)",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Tunica media",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "elastin",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "Tunica intima",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "arterioles",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "muscular arteries",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "elastic arteries",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "arteriole (histology)",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "muscular (distributing)",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "elastic (conducting)",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "sinusoidal cappilaries",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "fenestrated capillaries",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "continuous capillaries",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "precapillary sphincters",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "varicose vein",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "valve (vein)",
    "category": "veins and arteries",
    "definition": ""
  },
  {
    "name": "diastolic pressure",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "mean pressure",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "systolic pressure",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "aortic chemoreceptor",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "aortic baroreceptor",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "carotid body chemoreceptor",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "corotid sinus baroreceptor",
    "category": "blood pressure",
    "definition": ""
  },
  {
    "name": "vasomotor neurons",
    "category": "blood pressure",
    "definition": ""
  }
];

import { useState, useEffect } from 'react';


export const pickFromCVList = (_cvList, activeCard) => {
  const options = _cvList.filter(d => activeCard?.name !== d.name);

  if (!options.length) return null;

  const index = Math.floor(Math.random() * options.length);

  return options[index];
};

export const useCVList = () => {
  const [filteredCVList, setFilteredCVList] = useState(cvList);
  const [filters, setFilters] = useState(
    cvList.map(b => b.category).filter((value, index, array) => array.indexOf(value) === index)
  );
  const [selectedFilters, setSelectedFilters] = useState([]);
  const [seenCards, setSeenCards] = useState([]);
  const [activeCard, setActiveCard] = useState(null);

  useEffect(() => {
    setActiveCard(pickFromCVList(filteredCVList, activeCard));
  }, []);

  useEffect(() => {
    const _filteredCVList = cvList
      .filter(d => !seenCards.includes(d.name))
      .filter(d => !(selectedFilters.length && !selectedFilters.includes(d.category)));
    setFilteredCVList(_filteredCVList);
  }, [seenCards]);

  // useEffect(() => {
  //   setFilteredCVList(processCVList(cvList));
  // }, [cvList]);

  useEffect(() => {
    if (!filteredCVList.length) return;

    let _cvList = cvList
      .filter(d => !(selectedFilters.length && !selectedFilters.includes(d.category)))
      .filter(d => !seenCards.includes(d.name));

    setFilteredCVList(_cvList);

    setActiveCard(pickFromCVList(_cvList, activeCard));

  }, [selectedFilters])

  return {
    cvList: filteredCVList,
    filters,
    selectedFilters,
    setSelectedFilters,
    seenCards,
    pickFromCVList: (activeCard) => pickFromCVList(filteredCVList, activeCard),
    clearCards: () => {
      setSeenCards([]);
      setActiveCard(pickFromCVList(filteredCVList, null));
    },
    activeCard,
    nextRight: () => {
      setSeenCards([...seenCards, activeCard.name]);
      setActiveCard(pickFromCVList(filteredCVList, activeCard));
    },
    nextWrong: () => {
      setActiveCard(pickFromCVList(filteredCVList, activeCard));
    },
  };
};

